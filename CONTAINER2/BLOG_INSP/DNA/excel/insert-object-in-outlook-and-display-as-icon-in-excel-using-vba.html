<!DOCTYPE html>
<html>

  <head>
    <title>Insert an object in Outlook Created from File and Display as Icon from Excel using VBA</title>
    <meta name="description"
      content="Shared an Excel macro showing how to insert an object in outlook created from a file and display as icon using VBA" />
    <meta name="keywords" content="dynamically insert an object in outlook,display as icon using vba" />
    <meta name="author" content="Bryan Guner" />
    <meta https-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link type="image/x-icon"
      href="https://instructure-uploads-pdx.s3.us-west-2.amazonaws.com/account_168550000000000001/attachments/536/favicon_lambda_32.png"
      rel="shortcut icon">
    <link
      href="https://instructure-uploads-pdx.s3.us-west-2.amazonaws.com/account_168550000000000001/attachments/537/logo-canvas.png"
      rel="apple-touch-icon">
    <link rel="canonical"
      href="https://www.encodedna.com/excel/insert-object-in-outlook-and-display-as-icon-in-excel-using-vba.htm" />
    <link href="../css/style.css" type="text/css" rel="stylesheet" />
    <style>
      #nav-recentpost {
        margin: 0;
        padding: 0;
        display: block;
        overflow: hidden;
      }

      @media screen and (max-width: 900px) {
        #content {
          width: auto;
        }
      }

    </style>
  </head>

  <body>
    <noscript>
      <div style="width:100%;margin:0 auto;text-align:center;background-color:Yellow;">Please enable JavaScript to view
        this page properly.</div>
    </noscript>
    <div id="header-wrapper">
      <div id="header">
        <div style="float:left;"><a href="../index.html" title="web-dev-hub"><img src="../images/webdevhub.png"
              width="70%" alt="https://lambda-w-1-notes.netlify.app/" /></a></div>
  
        <div id="search_container">
          <script async src="https://cse.google.com/cse.js?cx=partner-pub-5222830587664038:4833961392"></script>
          <div class="gcse-searchbox-only"></div>
        </div>
      </div>
    </div>
    <div id="content">
      <div class="header">
        <h1>Insert an object in Outlook Created from File and Display as Icon from Excel using VBA</h1>
        <div class="tag"><a class="catonpage" href="../category/vba.html" title="vba">vba</a>
          <a class="catonpage" href="../category/msexcel.html" title="excel">excel</a></div>
        <p><span style="width:auto;text-align:right;"><a href="../index.html" title="Previous Post" class="quotelink"
              style="color:#999;">&#8592; Prev</a></span></p>
      </div>
      <div class="sidebar">
        <div style="padding-bottom:30px;clear:both;">
       
        </div>
        <h3>Tools you can use</h3>
        <div>
          <ul>
            <li><a href="../index.html">Online JavaScript Editor</a></li>
            <li><a href="../index.html">Bulk Image Resizer</a></li>
            <li><a href="../index.html">HTML Table Generator</a></li>
            <li><a href="../index.html">Easy Image Resizer</a></li>
            <li><a href="../index.html">Percentage (%) Calculator</a></li>
            <li><a href="../index.html">Hex to RGB Converter</a></li>
          </ul>
        </div>
        <div style="padding:50px 0;clear:both;" id="flDiv">
          <script async src="../pagead/js/adsbygoogle.js"></script><!-- LargeSky --><ins class="adsbygoogle"
            style="display:inline-block;width:300px;height:600px" data-ad-client="ca-pub-5222830587664038"
            data-ad-slot="4965879797"></ins>
          <script>
            ( adsbygoogle = window.adsbygoogle || [] ).push( {} );

          </script>
        </div>
      </div>
      <div class="post">
        <span class="Quote">You can insert a variety of <strong>objects</strong> like Excel workbook, PDF or Word
          document, images etc., in your email message using Outlook (any version), by clicking on various tabs, buttons
          and options. Or, you can automate this entire process. I’ll show you how you can do this dynamically with the
          click of a button from Excel using VBA.</span>
        <div class="top_ad" id="top_ad" style="margin:20px 0;">
          <script async src="../pagead/js/adsbygoogle.js"></script><!-- topleaderboard --><ins class="adsbygoogle"
            style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-5222830587664038"
            data-ad-slot="6690346257"></ins>
          <script>
            ( adsbygoogle = window.adsbygoogle || [] ).push( {} );

          </script>
        </div>
        <p>Typically, this is what you will do to embed an object in Outlook (manually).</p>
        <p><span style="color:#ffa54f;font-weight:bold;">1)</span> Open Ms-Outlook. Click the <span
            style="background-color:#f5f2f0;padding:0 3px;">New Email</span> tab (New in Outlook 2007) to create a new
          email message.</p>
        <p><span style="color:#ffa54f;font-weight:bold;">2)</span> Click <span
            style="background-color:#f5f2f0;padding:0 3px;">Format Text</span> (or <span
            style="background-color:#f5f2f0;padding:0 3px;">Options</span> if you are using Office 2007) from the top
          menu and click the <strong>Rich Text</strong> button. Since we want to add an Excel object, we have to
          <strong>change the format</strong> from default, which is HTML to <span
            style="background-color:#f5f2f0;padding:0 3px;">Rich Text</span>.</p>
        <p class="imagecontainer"><img src="../excel/outlook-select-rich-text-format.png" width="411px" height="255px"
            alt="Select Rich Text format in Outlook" title="Select Rich Text format in Outlook" /></p>
        <p><span style="color:#ffa54f;font-weight:bold;">3)</span> <strong>Next</strong>, click the <span
            style="background-color:#f5f2f0;padding:0 3px;">Insert</span> tab from the top menu. Find the
          <strong>Object</strong> option and click it.</p>
        <p class="imagecontainer"><img src="../excel/object-option-inside-insert-tab-in-ms-outlook.png" width="636px"
            height="258px" alt="Object option inside Insert tab in Ms-Outlook"
            title="Object option inside Insert tab in Ms-Outlook" /></p>
        <p><span style="color:#ffa54f;font-weight:bold;">4)</span> It will open an <span
            style="background-color:#f5f2f0;padding:0 3px;">Object</span> dialog box. Click the <strong>Create from
            File</strong> tab.</p>
        <p><span style="color:#ffa54f;font-weight:bold;">5)</span> Browse the file you want to insert, such as an Excel
          file. Choose the <strong>Display as icon</strong> check box and click <span
            style="background-color:#f5f2f0;padding:0 3px;">OK</span>.</p>
        <p class="imagecontainer"><img
            src="../excel/create-object-using-file-and-display-as-icon-in-ms-outlook-using-vba.png" width="510px"
            height="364px" alt="Create an in Ms-Outlook using file and Display as Icon using VBA"
            title="Create an in Ms-Outlook using file and Display as Icon" /></p>
        <p>Done! Now add <strong>To</strong> email id, a <strong>Subject</strong> line and Send the email.</p>
        <div style="text-align:center;">
          <script async src="../pagead/js/adsbygoogle.js"></script><!-- ed-right-large-rect --><ins class="adsbygoogle"
            style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-5222830587664038"
            data-ad-slot="6795298995"></ins>
          <script>
            ( adsbygoogle = window.adsbygoogle || [] ).push( {} );

          </script>
        </div>
        <h2>Macro to Insert an Object from File in Outlook</h2>
        <p><strong>Now</strong>, I’ll show you how you can automate the entire process that I have explained above,
          using VBA in Excel.</p>
        <p>Let us assume, you have file name <span style="background-color:#f5f2f0;padding:0 3px;">Books.xlsx</span> in
          the <span style="background-color:#f5f2f0;padding:0 3px;">D:\</span> drive.</p>
        <p>Here’s the macro.</p>
        <div class="code">
          <pre class="pre">
Option Explicit
Private Sub CommandButton1_Click()
    On Error GoTo ErrHandler
    <span class="comments">' Set Outlook object.</span>
    Dim objOutlook As <span style="color:#000;">Object</span>
    Set objOutlook = <span style="color:#000;">CreateObject</span>("Outlook.Application")
    <span class="comments">' Create email object.</span>
    Dim objEmail As <span style="color:#000;">Object</span>
    Set objEmail = objOutlook.<span style="color:#000;">CreateItem</span>(olMailItem)
    With objEmail
        .To = "arunbanik21@rediffmail.com, arun@hotmail.com"    <span class="comments">' Assign email ids to the property.</span>
        .Subject = "This is a text message from Arun"
        .<span style="color:#000;">BodyFormat</span> = olFormatRichText     <span class="comments">' Change the body format to Rich Text. (the default is HTML)</span>
        .Body = "Hi, there. Hope you are doing well."
        .Display        <span class="comments">' Open outlook for display. (Replace Display with Send, when you want to send the email.)</span>
    End With
    <span class="comments">' Clear all objects.</span>
    <span style="color:#000;">Set objEmail = Nothing:    Set objOutlook = Nothing</span>
    <span class="comments">' Once the emailing paramters are set and outlook is ready,</span>
    <span class="comments">' we'll insert or embed an object to the mail message.</span>
    <span style="color:#000;">insertExcelObject</span>
ErrHandler:
    '
End Sub
<span class="comments">' Insert an Excel file as object.</span>
Sub <span style="color:#000;">insertExcelObject</span>()
       Const sFileName As String = "d:\Books.xlsx"          <span class="comments">' The file that we'll insert as object.</span>
       Dim objRng As <span style="color:#000;">Object</span>
        If <span style="color:#000;">TypeName</span>(ActiveWindow) = "Window" Then
            If <span style="color:#000;">ActiveInspector</span>.IsWordMail And <span style="color:#000;">ActiveInspector</span>.EditorType = olEditorWord Then
                Set objRng = <span style="color:#000;">ActiveInspector</span>.WordEditor.Application.Selection
                objRng.<span style="color:#000;">InlineShapes.AddOLEObject</span> _
                    ClassType:="Excel.Sheet", _
                    <span style="color:#000;">DisplayAsIcon</span>:=True, _
                    <span style="color:#000;">IconFileName</span>:="EXCEL.EXE", _
                    IconLabel:=sFileName, _
                    fileName:=sFileName
           End If
       End If
End Sub</pre>
        </div>
        <p>Here's the output. <span style="color:#ffa54f;font-size:22px;font-weight:bold;">👇</span> This is how it will
          look.</p>
        <p class="imagecontainer"><img src="../excel/insert-object-in-outlook-and-display-as-icon-using-vba.gif"
            width="508px" height="262px" alt="Insert object in Outlook created from file and Display as Icon using VBA"
            title="Insert object in Outlook created from file and Display as Icon using VBA" /></p>
        <p><strong>Note</strong>: <span style="color:#ffa54f;font-size:22px;font-weight:bold;">👉</span> For more on how
          to send email from Excel using VBA, you can <a href="../index.html" class="contact">refer this article</a>.
        </p>
        <div style="text-align:center;">
          <script async src="../pagead/js/adsbygoogle.js"></script><!-- ed-right-large-rect --><ins class="adsbygoogle"
            style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-5222830587664038"
            data-ad-slot="6795298995"></ins>
          <script>
            ( adsbygoogle = window.adsbygoogle || [] ).push( {} );

          </script>
        </div>
        <h2>What this macro is doing?</h2>
        <p>Few things that you need to understand from the above macro. I am creating <strong>two</strong> objects
          inside the button’s click event. The first is an <strong>Outlook</strong> object (objOutlook) and second is
          the email object (objEmail).</p>
        <p>Using the email object <span style="background-color:#f5f2f0;padding:0 3px;">objEmail</span>, I have assigned
          few values like <span style="background-color:#f5f2f0;padding:0 3px;">To</span>, <span
            style="background-color:#f5f2f0;padding:0 3px;">Subject</span> etc. and most importantly the value to the
          <strong>BodyFormat</strong> property.</p>
        <p class="highlight">.BodyFormat = olFormatRichText</p>
        <p>The default format of the Body (of a message) is <span
            style="background-color:#f5f2f0;padding:0 3px;">HTML</span>. I am changing the format to <strong>Rich
            Text</strong>. Or else, I may not able to embed or insert an Object into email message.</p>
        <p><strong>Now</strong>, let’s understand the <span
            style="background-color:#f5f2f0;padding:0 3px;">insertExcelObect</span> procedure. This is where I am
          actually embedding an object to the Outlook message, created from a file, but displaying as
          <strong>icon</strong>. Therefore, I have created an OLE object of type <strong>InlineShapes</strong>.</p>
        <div class="code">
          <pre class="pre">
Dim objRng As Object
Set objRng = ActiveInspector.WordEditor.Application.Selection
objRng.<span style="color:#000;">InlineShapes</span>.AddOLEObject _</pre>
        </div>
        <p>The <a href="https://docs.microsoft.com/en-us/office/vba/api/word.inlineshapes.addoleobject"
            class="contact">InlineShapes.AddOLEOject method</a> takes few <span
            style="background-color:#f5f2f0;padding:0 3px;">parameters</span> like,</p>
        <p><span style="color:#ffa54f;font-weight:bold;">a)</span> <span
            style="background-color:#f5f2f0;padding:0 3px;">ClassType</span>: Its an Excel file that I am inserting.
          Therefore, the type is <strong>Excel.Sheet</strong>.</p>
        <p><span style="color:#ffa54f;font-weight:bold;">b)</span> <span
            style="background-color:#f5f2f0;padding:0 3px;">DisplayAsIcon</span>: Yes, we want to display an Excel icon
          in the message. Hence, its <strong>True</strong>.</p>
        <p><span style="color:#ffa54f;font-weight:bold;">c)</span> <span
            style="background-color:#f5f2f0;padding:0 3px;">IconFileName</span>: Here we’ll assign the application (or
          an exe) that contains the icon we want to show. Since its an Excel file, I have assigned
          <strong>EXCEL.EXE</strong>.<br /><br /><strong>Note</strong>: if you want the <span
            style="background-color:#f5f2f0;padding:0 3px;">Word</span> icon, assign <strong>WORD.EXE</strong>.</p>
        <p><span style="color:#ffa54f;font-weight:bold;">d)</span> <span
            style="background-color:#f5f2f0;padding:0 3px;">IconLabel</span>: I want to add a label to icon for better
          understanding. Therefore, I have assigned the <strong>filename</strong> itself.</p>
        <p><span style="color:#ffa54f;font-weight:bold;">e)</span> <span
            style="background-color:#f5f2f0;padding:0 3px;">fileName</span>: Finally, the file name.</p>
        <p>That's it. Thanks for reading. <span style="font:22px Calibri;">&#9786;</span></p>
        <p><span style="float:left;width:48%;text-align:left;"><a href="../index.html" title="Previous Post"
              class="quotelink"><span style="font-weight:bold;">&#8592; Previous</span></a></span></p><br />
        <div
          style="clear:both;width:98%;text-align:center;font:inherit;font-size:120%;font-style:italic;color:#17293C!important;padding:20px 0;margin:70px auto;border:dashed 2px #17293C;overflow:hidden;">
          <div style="margin:0 3px;font-size:110%;">Like this Article? Subscribe now, and get all the latest articles
            and tips, right in your inbox.</div>
          <div style="text-align:center;margin:0 auto;overflow:hidden;">
            <div style="width:auto;padding:18px 0;margin:0 auto;">
              <form style="border:none;" action="https://feedburner.google.com/fb/a/mailverify" method="post"
                target="popupwindow"
                onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=Encodednadotcom/Feed', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
                <input type="text" placeholder="Enter your email id"
                  style="font-size:15px;width:auto;height:22px;margin-right:5px;padding:3px 5px;border:1px solid #333;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;color:#000;"
                  name="email" /><input type="hidden" value="Encodednadotcom/Feed" name="uri" /><input type="hidden"
                  name="loc" value="en_US" /><input type="submit" value="Sign Up!" /><span
                  style="font-size:80%;color:#0086DC;padding-left:10px;">Delivered by <a
                    href="https://feedburner.google.com" style="color:#000;" target="_blank">FeedBurner</a></span>
              </form>
            </div>
          </div>
        </div>
      </div>
      <div id="nav-recentpost">
        <div><iframe src="../frametools/recentposts.html" scrolling="no" frameborder="0" class="frame-rp"></iframe>
        </div>
      </div>
    </div>
    <div id="site_footer">
      <div class="container">
        <ul id="footer"></ul>
      </div>
    </div>
    <script async src="../library/encodedna_script.js" onload="init();"></script>
  </body>
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push( [ '_setAccount', 'UA-37088350-1' ] );
    _gaq.push( [ '_trackPageview' ] );
    ( function () {
      var ga = document.createElement( 'script' );
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ( 'https:' == document.location.protocol ? 'https://ssl' : 'https://www' ) +
        '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName( 'script' )[ 0 ];
      s.parentNode.insertBefore( ga, s );
    } )();
    ( function () {
      var po = document.createElement( 'script' );
      po.type = 'text/javascript';
      po.async = true;
      po.src = '../js/plusone.js';
      var s = document.getElementsByTagName( 'script' )[ 0 ];
      s.parentNode.insertBefore( po, s );
    } )();

  </script>
  <script type="text/javascript" src="../coop/cse/brand_form_cse-search-box_lang_en.js"></script>

</html>
