<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <meta name="GENERATOR" content="Mozilla/4.0 [en] (WinNT; I) [Netscape]" />
    <title>COBOL Report Writer - Syntax and Semantics</title>
  </head>
  <body
    text="#000000"
    bgcolor="#FFFFFF"
    link="#0000FF"
    vlink="#FF0000"
    alink="#009B00"
  >
    <table border="1" width="715">
      <tr>
        <td>
          <table width="710" cellpadding="4" cellspacing="0" border="0">
            <tr>
              <td
                valign="top"
                align="left"
                width="700"
                bgcolor="#FFFFFF"
                colspan="2"
              >
                <center>
                  <h2>
                    <img
                      src="Resources/pics/t-CobolCourse.gif"
                      height="56"
                      width="161"
                      align="MIDDLE"
                      alt="Cobol Course"
                      border="0"
                    />
                  </h2>
                </center>
                <center>
                  <h2><b>The COBOL Report Writer - Syntax and Semantics</b></h2>
                  <hr />
                </center>
                <table border="0" width="700" vspace="15">
                  <tr>
                    <td width="3%" valign="TOP">&nbsp;</td>
                    <td width="4%" valign="TOP">
                      <img
                        src="Resources/pics/BallGreenG.gif"
                        hspace="4"
                        height="13"
                        width="13"
                        align="TOP"
                        vspace="4"
                      />
                    </td>
                    <td width="93%">
                      <p>
                        <b><a href="#intro" target="">Introduction</a><br /> </b
                        ><font size="-1"
                          >Unit aims, objectives and prerequisites.</font
                        >
                        <br />
                      </p>
                    </td>
                  </tr>
                  <tr>
                    <td width="3%" valign="TOP">&nbsp;</td>
                    <td width="4%" valign="TOP">
                      <img
                        src="Resources/pics/BallGreenG.gif"
                        hspace="4"
                        height="13"
                        width="13"
                        align="TOP"
                        vspace="4"
                      />
                    </td>
                    <td width="93%">
                      <p>
                        <b
                          ><a href="#part1" target=""
                            >Defining the Report - Report File entries</a
                          ><br /> </b
                        ><font size="-1"
                          >This section examines the Environment Division and
                          File Section entries required when we create
                          <br />
                          a Report Writer program.</font
                        ><font size="-1"> <br /> </font>
                      </p>
                    </td>
                  </tr>
                  <tr>
                    <td width="3%" valign="TOP">&nbsp;</td>
                    <td width="4%" valign="TOP">
                      <img
                        src="Resources/pics/BallGreenG.gif"
                        hspace="4"
                        height="13"
                        width="13"
                        align="TOP"
                        vspace="4"
                      />
                    </td>
                    <td width="93%">
                      <p>
                        <b
                          ><a href="#part2" target=""
                            >Defining the Report - Report Description (RD)
                            entries </a
                          ><br /> </b
                        ><font size="-1"
                          >In this section we examine the Report Section and the
                          Report Description (RD) entries required to
                          <br />
                          define a report. <br />
                        </font>
                      </p>
                    </td>
                  </tr>
                  <tr>
                    <td width="3%" valign="TOP">&nbsp;</td>
                    <td width="4%" valign="TOP">
                      <img
                        src="Resources/pics/BallGreenG.gif"
                        hspace="4"
                        height="13"
                        width="13"
                        align="TOP"
                        vspace="4"
                      />
                    </td>
                    <td width="93%">
                      <p>
                        <b
                          ><a href="#part3" target=""
                            >Defining the Report - Report Group entries</a
                          ><br /> </b
                        ><font size="-1"
                          >This section examines the entries required to define
                          a report group record.<br />
                        </font>
                      </p>
                    </td>
                  </tr>
                  <tr>
                    <td width="3%" valign="TOP">&nbsp;</td>
                    <td width="4%" valign="TOP">
                      <img
                        src="Resources/pics/BallGreenG.gif"
                        hspace="4"
                        height="13"
                        width="13"
                        align="TOP"
                        vspace="4"
                      />
                    </td>
                    <td width="93%">
                      <p>
                        <b
                          ><a href="#part4" target=""
                            >Defining the Report - Lines and Columns</a
                          ><br /> </b
                        ><font size="-1"
                          >This section examines the entries the vertical and
                          horizontal placement of print items. </font
                        ><font size="-1"
                          >It examines <br />
                          clauses such as - </font
                        ><font size="-1"
                          >LINE NUMBER, COLUMN NUMBER, GROUP INDICATE , SOURCE
                          and SUM</font
                        ><font size="-1">.<br /> </font>
                      </p>
                    </td>
                  </tr>
                  <tr>
                    <td width="3%" valign="TOP">&nbsp;</td>
                    <td width="4%" valign="TOP">
                      <img
                        src="Resources/pics/BallGreenG.gif"
                        hspace="4"
                        height="13"
                        width="13"
                        align="TOP"
                        vspace="4"
                      />
                    </td>
                    <td width="93%">
                      <p>
                        <a href="#part5" target=""
                          ><b>Special Report Writer registers</b></a
                        ><br />
                        <font size="-1"
                          >In this section the LINE-COUNTER and PAGE-COUNTER
                          registers are examined.<br />
                        </font>
                      </p>
                    </td>
                  </tr>
                  <tr>
                    <td width="3%" valign="TOP">&nbsp;</td>
                    <td width="4%" valign="TOP">
                      <img
                        src="Resources/pics/BallGreenG.gif"
                        hspace="4"
                        height="13"
                        width="13"
                        align="TOP"
                        vspace="4"
                      />
                    </td>
                    <td width="93%">
                      <p>
                        <b
                          ><a href="#part6" target=""
                            >The Procedure Division Verbs </a
                          ><br /> </b
                        ><font size="-1"
                          >This section introduces the INITIATE, GENERATE and
                          TERMINATE verbs. <br />
                        </font>
                      </p>
                    </td>
                  </tr>
                  <tr>
                    <td width="3%" valign="TOP">&nbsp;</td>
                    <td width="4%" valign="TOP">
                      <img
                        src="Resources/pics/BallGreenG.gif"
                        hspace="4"
                        height="13"
                        width="13"
                        align="TOP"
                        vspace="4"
                      />
                    </td>
                    <td width="93%">
                      <div align="left">
                        <p>
                          <b
                            ><a href="#part7" target=""
                              >Report Writer Declaratives</a
                            ></b
                          ><b>
                            <br /> </b
                          ><font size="-1"
                            >In this section elements of the Declaratives, such
                            as USE BEFORE REPORTING, SUPPRESS PRINTING and
                            <br />
                            control break registers, are examined.<br />
                          </font>
                        </p>
                      </div>
                    </td>
                  </tr>
                </table>
              </td>
            </tr>
            <tr>
              <td
                valign="top"
                align="LEFT"
                width="700"
                bgcolor="#993300"
                colspan="2"
              >
                <h2 align="CENTER">
                  <font color="#FFFF00"
                    ><a name="intro"></a
                    ><font face="Arial, Helvetica, sans-serif"
                      >Introduction</font
                    ></font
                  >
                </h2>
              </td>
            </tr>
            <tr>
              <td valign="top" width="160" bgcolor="#FFFFCC">
                <h4>
                  <font color="#993300" face="Arial, Helvetica, sans-serif"
                    >Aims</font
                  >
                </h4>
              </td>
              <td width="540">
                <p>
                  The unit provides a Report Writer reference. The syntax
                  elements of the Report Writer are presented and the semantics
                  of their operation discussed.
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="top" align="LEFT" width="160" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Objectives</font
                  >
                </h4>
              </td>
              <td width="540">
                <p>By the end of this unit you should -</p>
                <ol>
                  <li>
                    Know how to set up a report file in the Environment Division
                    and the File Section.
                  </li>
                  <li>
                    Be able to define a report and the appropriate report groups
                    in the Report Section.
                  </li>
                  <li>
                    Understand how Declaratives may be used to extend the
                    functionality of the Report Writer.
                  </li>
                  <li>
                    Be able to write the Procedure Division code (using the
                    INITIATE, GENERATE and TERMINATE verbs) to create a report.
                  </li>
                </ol>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="top" align="LEFT" width="160" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Prerequisites</font
                  >
                </h4>
              </td>
              <td width="525">
                <p>
                  You should be familiar with the material covered in the units;
                </p>
                <ul>
                  <li>Sequential files</li>
                  <li>Data Declaration</li>
                  <li>The Report Writer</li>
                </ul>
              </td>
            </tr>
            <tr>
              <td
                valign="top"
                align="left"
                width="700"
                bgcolor="#FFFFFF"
                colspan="2"
              >
                <div align="center">
                  <hr />
                  <p>
                    <a href="#top">
                      <img
                        src="Resources/pics/i-pagetop.gif"
                        width="132"
                        height="38"
                        border="0"
                    /></a>
                  </p>
                  <p>&nbsp;</p>
                </div>
              </td>
            </tr>
            <tr>
              <td
                valign="top"
                align="LEFT"
                width="700"
                bgcolor="#993300"
                colspan="2"
              >
                <h2 align="CENTER">
                  <font color="#FFFF00"
                    ><a name="part1"></a
                    ><font face="Arial, Helvetica, sans-serif"
                      >Defining the Report - Report File entries</font
                    ></font
                  >
                </h2>
              </td>
            </tr>
            <tr>
              <td valign="top" align="LEFT" width="160" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Environment Division entries</font
                  >
                </h4>
              </td>
              <td width="540" valign="top">
                <p>
                  Just like ordinary reports, the reports generated by the
                  Report Writer are written to an external device - usually a
                  report file.
                </p>
                <p>
                  The Environment Division entries for a report file are the
                  same as those for an ordinary file. The same Select and Assign
                  clauses apply.
                </p>
                <p>
                  For instance, in the program fragment below, the Select and
                  Assign for the final example program (given in the previous
                  Report Writer unit) is shown.
                </p>
                <p>
                  When the Report Writer generates this report it will be stored
                  in the file <font size="-1">SALESREPORT.LPT</font>.
                </p>
                <table
                  border="1"
                  width="100%"
                  background="Resources\pics\code.gif"
                >
                  <tr>
                    <td>
                      <pre>ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT SalesFile ASSIGN TO "GBPAY.DAT"
           ORGANIZATION IS LINE SEQUENTIAL.
   <FONT color="#FF0000"><B> SELECT PrintFile ASSIGN TO "SALESREPORT.LPT".</B></FONT>


DATA DIVISION.
FILE SECTION.
FD  SalesFile.
01  SalesRecord.
    88 EndOfFile  VALUE HIGH-VALUES.
    02 CityCode         PIC 9.
    02 SalesPersonNum   PIC 9.
    02 ValueOfSale      PIC 9(4)V99.

<B><FONT color="#FF0000">FD  PrintFile
    REPORT IS SalesReport.

</FONT></B><FONT color="#FF0000"><FONT color="#000000">    : intervening entries :
    : intervening entries :</FONT></FONT><B><FONT color="#FF0000">

</FONT></B><FONT color="#FF0000"><FONT color="#000000">REPORT SECTION.</FONT></FONT><B><FONT color="#FF0000"><FONT color="#000000">
<B><FONT color="#FF3300">RD  SalesReport</FONT></B>
</FONT></FONT></B><FONT color="#FF0000"><FONT color="#000000">    CONTROLS ARE FINAL
                 CityCode
                 SalesPersonNum 
    PAGE LIMIT IS 66
    HEADING 1
    FIRST DETAIL 6
    LAST DETAIL 42
    FOOTING 52.</FONT></FONT><B><FONT color="#FF0000"><FONT color="#000000">
</FONT></FONT></B></pre>
                    </td>
                  </tr>
                </table>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif">
                    File Section entries</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  Although the entries in the Environment Division are the same
                  as those for ordinary print files, in the File Section the
                  normal file description is replaced by phrase which points to
                  the Report Description (RD) in the Report Section. The syntax
                  of the phrase is -
                </p>
                <p align="center">
                  <img
                    src="Resources/pics/rwReportIS.gif"
                    width="222"
                    height="48"
                  />
                </p>
                <div align="center"></div>
                <p>
                  The <i>ReportName</i> must be the same as the
                  <i>ReportName</i> used in the Report Description (RD) entry.
                </p>
                <p>
                  You can see this in the program fragment above where the
                  <b>REPORT IS</b><b> SalesReport</b> phrase links the PrintFile
                  with the Report Description(RD) in the Report Section.
                </p>
                <p><b>Notes:</b></p>
                <p>
                  Before the report can be used it must be opened for output.
                  For instance in the example above the PrintFile must be opened
                  for output before the SalesReport can be generated.
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" bgcolor="#993300" colspan="2">
                <h2 align="CENTER">
                  <font color="#FFFF00" face="Arial, Helvetica, sans-serif"
                    ><a name="part2"></a>Defining the Report - Report
                    Description (RD) Entries</font
                  >
                </h2>
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Introduction</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  Every report generated by the Report Writer must have a Report
                  Description (RD) entry in the Report Section.
                </p>
                <p>
                  The RD entry names the report and specifies the format of the
                  printed page and identifies the control break items.
                </p>
                <p>
                  Each RD entry is followed by one or more 01 level-number
                  entries. Each 01 level-number entry identifies a report group
                  and consists of a hierarchical structure similar to a COBOL
                  record.
                </p>
                <p>
                  Each report group is a unit consisting of one or more print
                  lines and cannot be split across pages.
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The Report Description (RD) entries - Syntax</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The syntax for the Report Description (RD) entries is shown
                  below -
                </p>
                <p align="center">
                  <img src="Resources/pics/rwRD.gif" width="360" height="277" />
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The Report Description (RD) entries - Semantics</font
                  >
                </h4>
                <h4 align="center">&nbsp;</h4>
                <h4 align="center">&nbsp;</h4>
              </td>
              <td width="525" valign="top">
                <p align="center"><b>RD Rules</b></p>
                <ol>
                  <li>
                    The <i>ReportName</i> can only appear in one RD entry.
                  </li>
                  <li>
                    When more than one report is declared in the Report Section
                    the <i>ReportName</i> can be used to qualify the
                    LINE-COUNTER and PAGE-COUNTER report registers.
                  </li>
                </ol>
                <hr width="50%" />
                <p align="center"><b>CONTROL Rules</b></p>
                <ol>
                  <li>
                    The <i>ControlName$#i </i>must not be defined in the Report
                    Section.
                  </li>
                  <li>
                    Each occurrence of <i>ControlName$#i </i>must identify a
                    different data item.
                  </li>
                  <li>
                    The <i>ControlName$#i</i> must not have a variable length
                    table subordinate to it.
                  </li>
                  <li>
                    <i>ControlName$#i</i> and FINAL specify the levels of the
                    control break hierarchy where FINAL (if specified) is the
                    highest and the first <i>ControlName$#i</i> the next highest
                    and so on.
                  </li>
                  <li>
                    When the value in any <i>ControlName$#i</i> changes a
                    control break occurs. The level of the control break depends
                    on the position of the <i>ControlName$#i </i>in the control
                    break hierarchy.
                  </li>
                </ol>
                <hr width="50%" />
                <p align="center"><b>PAGE Rules</b></p>
                <ol>
                  <li>
                    <i>HeadingLine#l</i> must be greater than or equal to 1.
                  </li>
                  <li>
                    <i>HeadingLine#l</i> &lt;= <i>FirstDetailLine#l</i> &lt;=
                    <i>LastDetailLine#l </i>&lt;= <i>FootingLine#l</i> &lt;=
                    <i>PageSize#l</i>
                  </li>
                  <li>
                    Line numbers used in a Report Heading or Page Heading group
                    must be greater than or equal to <i>HeadingLine#l</i> and
                    less than <i>FirstDetailLine#l</i> but when a Report Heading
                    appears on a page by itself any line number between
                    <i>HeadingLine#l</i> and <i>PageSize#l</i> may be used.
                  </li>
                  <li>
                    Line numbers used in Detail or Control Heading groups must
                    be in the range <i>FirstDetailLine#l </i>to
                    <i>LastDetailLine#l</i> inclusive.
                  </li>
                  <li>
                    Line numbers used in Control Footing groups must be in the
                    range <i>FirstDetailLine#l FootingLine#l</i> inclusive
                  </li>
                  <li>
                    Line numbers used in the Report Footing or Page Footing
                    groups must be greater than<i> FootingLine#l </i>and less
                    than or equal to <i>PageSize#l</i> but when a Report Footing
                    appears on a page by itself any line number between
                    <i>HeadingLine#l</i> and <i>PageSize#l</i> may be used.
                  </li>
                  <li>
                    All report groups must be defined so that they can be
                    presented on one page. The Report Writer never splits a
                    multi-line group across page boundaries.
                  </li>
                </ol>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" bgcolor="#993300" colspan="2">
                <h2 align="CENTER">
                  <font color="#FFFF00" face="Arial, Helvetica, sans-serif"
                    ><a name="part3"></a></font
                  ><font color="#FFFF00"
                    ><font face="Arial, Helvetica, sans-serif"
                      >Defining the Report - Report Group entries</font
                    ></font
                  >
                </h2>
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Introduction</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  In the Report Section each report group is represented by a
                  report group record. As with all record descriptions in COBOL
                  a report group record starts with level number 01. Subordinate
                  items in the record describe the report lines and columns
                  within the report group.
                </p>
                <p>
                  The description of a report group consists of a number of
                  hierarchic levels. At the top must be the Report Group
                  Definition.
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Defining a Report Group Record - Syntax</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  <b><font size="+1">Report Group Definition</font></b>
                </p>
                <p>
                  <img
                    src="Resources/pics/rwGroupType.gif"
                    width="405"
                    height="512"
                  />
                </p>
                <p>&nbsp;</p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    ><i>ReportGroupName </i>Rules
                  </font>
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The <i>ReportGroupName</i> is required only when the group -
                </p>
                <ol>
                  <li>
                    is a detail group referenced by a
                    <font size="-1">GENERATE</font> statement or the
                    <font size="-1">UPON</font> phrase of a
                    <font size="-1">SUM</font> clause.
                  </li>
                  <li>
                    is referenced in a
                    <font size="-1">USE BEFORE REPORTING</font> sentence in the
                    Declaratives
                  </li>
                  <li>
                    is required to qualify the reference to a sum counter.
                  </li>
                </ol>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The LINE NUMBER clause</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The <font size="-1">LINE NUMBER</font> clause is used to
                  specify the vertical positioning of print lines. Lines can be
                  printed on -
                </p>
                <ul>
                  <ul>
                    <li>a specified line (absolute)</li>
                    <li>a specified line on the next page (absolute)</li>
                    <li>
                      the current line number plus some increment (relative)
                    </li>
                  </ul>
                </ul>
                <p><b>Rules:</b></p>
                <ol>
                  <li>
                    The <font size="-1">LINE NUMBER </font>clause specifies
                    where each line is to be printed so no item that contains a
                    <font size="-1">LINE NUMBER</font> clause may contain a
                    subordinate item that also contains a
                    <font size="-1">LINE NUMBER</font> clause (subordinate items
                    specify the column items).
                  </li>
                  <li>
                    Where absolute <font size="-1">LINE NUMBER</font> clauses
                    are specified all absolute clauses must precede all relative
                    clauses and the line numbers specified in the successive
                    absolute clauses must be in ascending order.
                  </li>
                  <li>
                    The first <font size="-1">LINE NUMBER</font> clause
                    specified in a <font size="-1">PAGE FOOTING</font> group
                    must be absolute.
                  </li>
                  <li>
                    The <font size="-1">NEXT PAGE</font> clause can only appear
                    once in a given report group description and it must be in
                    the first <font size="-1">LINE NUMBER</font> clause in the
                    report group.
                  </li>
                  <li>
                    The <font size="-1">NEXT PAGE</font> clause cannot appear in
                    any <font size="-1">HEADING</font> group.
                  </li>
                </ol>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The NEXT GROUP clause</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The <font size="-1">NEXT GROUP</font> clause is used to
                  specify the vertical positioning of the start of the next
                  group. The <font size="-1">NEXT GROUP</font> clause can be
                  used to specify that the next report groups should be printed
                  on -
                </p>
                <ul>
                  <ul>
                    <li>a specified line (absolute)</li>
                    <li>
                      the current line number plus some increment (relative)
                    </li>
                    <li>the next page</li>
                  </ul>
                </ul>
                <p><b>Rules</b></p>
                <p>
                  The <font size="-1">NEXT PAGE</font> option in the
                  <font size="-1">NEXT GROUP</font> clause must not be specified
                  in a page footing.
                </p>
                <p>
                  The <font size="-1">NEXT GROUP</font> clause must not be
                  specified in a <font size="-1">REPORT FOOTING</font> or
                  <font size="-1">PAGE HEADING</font> group.
                </p>
                <p>
                  When used in a <font size="-1">DETAIL</font> group the
                  <font size="-1">NEXT GROUP</font> clause refers to the next
                  <font size="-1">DETAIL</font> group to be printed.
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The TYPE clause</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The TYPE clause specifies the type of the report group. The
                  type of the report group governs when and where will be
                  printed in the the report (for instance, a
                  <font size="-1">REPORT HEADING</font> group is printed only
                  once - at the beginning of the report).
                </p>
                <p><b>Rules</b></p>
                <p>
                  Most groups are defined once for each report but control
                  groups (other than
                  <font size="-1">CONTROL ..FINAL</font> groups) are defined for
                  each control break item.
                </p>
                <p>
                  In <font size="-1">REPORT FOOTING</font>, and
                  <font size="-1">CONTROL FOOTING</font> groups,
                  <font size="-1">SOURCE</font> and
                  <font size="-1">USE</font> clauses must not reference any data
                  item which contains a control break item or is subordinate to
                  a control break item.
                </p>
                <p>
                  <font size="-1">PAGE HEADING</font> or
                  <font size="-1">FOOTING</font> groups must not reference a
                  control break item or any item subordinate to a control break
                  item.
                </p>
                <p>
                  <font size="-1">DETAIL</font> report groups are processed when
                  they are referenced in a
                  <font size="-1">GENERATE </font>statement. All other groups
                  are processed automatically by the Report Writer. There can be
                  more than one <font size="-1">DETAIL</font> group.
                </p>
                <p>
                  The <font size="-1">REPORT HEADING</font>,
                  <font size="-1">PAGE HEADING</font>,
                  <font size="-1">CONTROL HEADING FINAL</font>,
                  <font size="-1">CONTROL FOOTING FINAL</font>,
                  <font size="-1">PAGE FOOTING</font> and
                  <font size="-1">REPORT FOOTING</font> report groups can each
                  appear only once in the description of a report.
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" bgcolor="#993300" colspan="2">
                <h2 align="CENTER">
                  <font color="#FFFF00" face="Arial, Helvetica, sans-serif"
                    ><a name="part4"></a></font
                  ><font color="#FFFF00"
                    ><font face="Arial, Helvetica, sans-serif"
                      >Defining the Report - Lines and Columns</font
                    ></font
                  >
                </h2>
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Introduction</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The subordinate items in a report group record describe the
                  report lines and columns within the report group. There are
                  two formats for defining items subordinate to the report group
                  record. The first is usually used to define the lines of the
                  report group and the second to define and position the
                  elementary print items.
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Defining Report Lines
                  </font>
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  Print lines in a report group are usually defined using the
                  format shown below. This format is used to specify the
                  vertical placement of a print line and it is always followed
                  by subordinate items that specify the columns where the data
                  items are to be printed.
                </p>
                <p>
                  As shown in the syntax diagram below the level number is from
                  2 to 48 inclusive.
                </p>
                <p>
                  If the <i>ReportLineName </i>is used its only purpose is to
                  qualify a sum counter reference.
                </p>
                <p>&nbsp;</p>
                <p>
                  <img
                    src="Resources/pics/rwGroupDesc1.gif"
                    width="364"
                    height="74"
                  />
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="center">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Defining Elementary print items in a report group</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  Elementary print items in the print line of a report group are
                  described using the syntactic elements shown in the diagram
                  below.
                </p>
                <p>
                  As we can see from the syntax diagram, the normal data
                  description clauses such as <font size="-1">PIC</font>,
                  <font size="-1">USAGE</font>, <font size="-1">SIGN</font>,
                  <font size="-1">JUSTIFIED</font>,
                  <font size="-1">BLANK WHEN ZERO</font> and
                  <font size="-1">VALUE</font> may be applied when describing an
                  elementary print item. The Report Writer provides a number of
                  additional clauses that may also be used.
                </p>
                <p>
                  The <i>PrintItemName</i> can only be referenced if the entry
                  uses the <font size="-1">SUM</font> clause to define a sum
                  counter.
                </p>
                <p>
                  <img
                    src="Resources/pics/rwGroupDesc2.gif"
                    width="413"
                    height="456"
                  />
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4 align="left">
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The COLUMN NUMBER clause</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The <font size="-1">COLUMN NUMBER</font> specifies the
                  position of a print item on the print line. When this clause
                  is used it must be subordinate to an item that contains a
                  <font size="-1">LINE NUMBER</font> clause.
                </p>
                <p>
                  Within a given print line the <i>ColNum#l's </i>should be in
                  ascending sequence.
                </p>
                <p>
                  <i>ColNum#l</i> specifies the column number of the leftmost
                  character position of the print item.
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The GROUP INDICATE clause</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The <font size="-1">GROUP INDICATE</font> is used to specify
                  that a print item should be printed only on the first
                  occurrence of its report group after a control break or page
                  advance.
                </p>
                <p>
                  For instance in the full version of the example program the
                  CityName and SalesPersonNum are suppressed after their first
                  occurrence.
                </p>
                <table
                  border="1"
                  width="100%"
                  background="Resources\pics\code.gif"
                >
                  <tr>
                    <td>
                      <pre>01  DetailLine TYPE IS DETAIL.
    02 LINE IS PLUS 1.
       03 COLUMN 1      PIC X(9)
                        SOURCE CityName(CityCode) <FONT color="#FF0000"><B>GROUP INDICATE</B></FONT>.
       03 COLUMN 15     PIC 9
                        SOURCE SalesPersonNum  <B><FONT color="#FF0000">GROUP INDICATE</FONT></B>.
       03 COLUMN 25     PIC $$,$$$.99 SOURCE ValueOfSale.</PRE>
                    </td>
                  </tr>
                </table>
                <p>
                  The <font size="-1">GROUP INDICATE</font> clause can only
                  appear in a <font size="-1">DETAIL</font> report group
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The SOURCE clause</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The SOURCE clause is used to identify a data item that
                  contains the value to be used when the print-item is printed.
                  For instance, the SOURCE<i> ValueOfSale</i> clause in the
                  example above specifies that the value of the item to be
                  printed in column 25 is to be found in the data-item
                  ValueOfSale.
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The SUM clause</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The SUM clause is used both to establish a sum counter and to
                  name the data-items to be summed.
                </p>
                <p>Three forms of summing can be done in the Report Writer;</p>
                <ol>
                  <ol>
                    <li>Subtotalling</li>
                    <li>Rolling Forward</li>
                    <li>Cross footing</li>
                  </ol>
                </ol>
                <hr />
                <h4><b>Subtotalling</b></h4>
                <p>
                  In Subtotalling, each time a
                  <font size="-1">GENERATE</font> statement is executed the
                  value to be summed is added to the sum counter.
                </p>
                <hr />
                <h4><b>Rolling Forward</b></h4>
                <p>
                  In Rolling Forward the value accumulated in the sum counter of
                  one group is used as the value to be summed in the sum counter
                  of another group.
                </p>
                <p>
                  The full version of the example program contains a good
                  example of both Subtotalling and Rolling forward. The SUM
                  clause is used to accumulate the ValueOfSale into a sum
                  counter named as SMS (Subtotalling). The SMS sum counter is
                  used as the value to be summed into the CS sum counter and CS
                  is used as the value to be summed into the final total
                  (Rolling Forward).
                </p>
                <p>
                  In the example code fragment below, each time a
                  <font size="-1">DETAIL</font> line is
                  <font size="-1">GENERATED</font> the ValueOf Sale is added to
                  the SMS sum counter. When a control break occurs on
                  SalesPersonNum the accumulated sum is printed and is added to
                  the CS sum counter. When a control break occurs on the
                  CityCode the sum accumulated in the CS sum counter is added to
                  the final total sum counter.
                </p>
                <table
                  border="1"
                  width="100%"
                  background="Resources\pics\code.gif"
                >
                  <tr>
                    <td>
                      <pre>01  SalesPersonGrp
    TYPE IS CONTROL FOOTING SalesPersonNum  NEXT GROUP PLUS 2.
                      :<I> other entries</I> :
                      :<I> other entries</I> :
       03 <FONT color="#FF0000"><B>SMS</B></FONT> COLUMN 45 PIC $$$$$,$$$.99 <FONT color="#FF0000"><B>SUM ValueOfSale</B></FONT>.



01  CityGrp TYPE IS CONTROL FOOTING CityCode NEXT GROUP PLUS 2.
                      :<I> other entries</I> :
                      :<I> other entries</I> :
       03 <B><FONT color="#FF0000">CS</FONT></B> COLUMN 45  PIC $$$$$,$$$.99 <FONT color="#FF0000"><B>SUM SMS</B></FONT>.



01  TotalSalesGrp TYPE IS CONTROL FOOTING FINAL.
                      :<I> other entries</I> :
                      :<I> other entries</I> :
       03 COLUMN 45     PIC $$$$$,$$$.99 <B><FONT color="#FF0000">SUM CS</FONT></B>.</PRE>
                    </td>
                  </tr>
                </table>
                <hr />
                <h4><b>Cross Footing</b></h4>
                <p>
                  In Cross Footing sum counters in the same report group can be
                  added together. In the example below, each time a GENERATE
                  statement is executed the value of the SalesPersonSale is
                  added to the SPS sum counter and the value of CounterSale is
                  added to SCS (Subtotalling). When a control break occurs on
                  ShopNum the values of the SPS and SCS sum counters are added
                  together to give the combined total printed in column 60
                  (Cross Footing).
                </p>
                <table
                  border="1"
                  width="100%"
                  background="Resources\pics\code.gif"
                >
                  <tr>
                    <td>
                      <pre>01  ShopTotalsGrp
    TYPE IS CONTROL FOOTING ShopNum  NEXT GROUP PLUS 2.
                      :<I> other entries</I> :
                      :<I> other entries</I> :
       03 <FONT color="#FF0000"><B>SPS</B></FONT> COLUMN 20 PIC $$$,$$$.99  <FONT color="#FF0000"><B>SUM SalesPersonSale</B></FONT>.
       03 <FONT color="#FF0000"><B>SCS</B></FONT> COLUMN 40 PIC $$$,$$$.99  <FONT color="#FF0000"><B>SUM CounterSale</B></FONT>.
       03     COLUMN 60 PIC $$$$,$$$.99 <FONT color="#FF0000"><B>SUM SPS, SCS</B></FONT>.
</PRE>
                    </td>
                  </tr>
                </table>
                <h4>&nbsp;</h4>
                <h4>Rules</h4>
                <ol>
                  <li>
                    If the the SUM..UPON <i>ReportGroupName</i> clause is used
                    then the value is only added to the sum counter when the
                    specified report group is printed.
                  </li>
                  <li>
                    A SUM clause can appear only in the description of a
                    <font size="-1">CONTROL FOOTING </font>report group.
                  </li>
                  <li>
                    Statements in the Procedure Division can be used to alter
                    the contents of the sum counters.
                  </li>
                </ol>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The RESET ON clause</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  Sum counters are normally reset to zero after a control break
                  on the control break item associated with the report group but
                  the <font size="-1">RESET</font> clause can be used to reset
                  the sum counters on the break of a more senior control item.
                </p>
                <h4>Rules</h4>
                <ol>
                  <li>
                    The <i>ControlBreakItem#$i </i>must be one of the data items
                    mentioned in the
                    <font size="-1">CONTROL/CONTROLS</font> clause in the Report
                    Description.
                  </li>
                </ol>
              </td>
            </tr>
            <tr>
              <td
                valign="top"
                align="LEFT"
                width="700"
                bgcolor="#993300"
                colspan="2"
              >
                <h2 align="CENTER">
                  <font color="#FFFF00"
                    ><a name="part5"></a
                    ><font face="Arial, Helvetica, sans-serif"
                      >Special Report Writer registers</font
                    ></font
                  >
                </h2>
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Introduction</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <div align="center">
                  <p align="left">
                    The Report Writer maintains two special registers for each
                    report declared in the Report Section. The two registers are
                    -
                  </p>
                </div>
                <div align="left">
                  <blockquote>
                    <blockquote>
                      <blockquote>
                        <p align="center">
                          the LINE-COUNTER<br />
                          and<br />
                          the PAGE-COUNTER
                        </p>
                      </blockquote>
                    </blockquote>
                  </blockquote>
                </div>
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif">
                    The LINE-COUNTER register</font
                  >
                </h4>
                <h3>&nbsp;</h3>
                <div align="right"></div>
              </td>
              <td width="525" valign="top">
                <p align="left">
                  The reserved word <font size="-1">LINE-COUNTER</font> can be
                  used to access a special register that the Report Writer
                  maintains for each report in the Report Section.
                </p>
                <p align="left">
                  The Report Writer uses the
                  <font size="-1">LINE-COUNTER</font> register to keep track of
                  where the lines are being printed on the report. It uses this
                  information and the information specified in the
                  <font size="-1">PAGE LIMIT</font> clause in the RD entry to
                  decide when a new page is required.
                </p>
                <p align="left">
                  While the <font size="-1">LINE-COUNTER </font>register can be
                  used as a <font size="-1">SOURCE</font> item in the report no
                  statements in the Procedure Division can alter the value in
                  the register.
                </p>
                <p align="left">
                  References to the <font size="-1">LINE-COUNTER</font> register
                  can be qualified by referring to the name of the report given
                  in the RD entry.
                </p>
                <hr />
              </td>
            </tr>
            <tr></tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The PAGE-COUNTER register</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <div align="center">
                  <p align="left">
                    The reserved word <font size="-1">PAGE-COUNTER</font> can be
                    used to access a special register that the Report Writer
                    maintains for each report in the Report Section.
                  </p>
                  <p align="left">
                    The <font size="-1">PAGE-COUNTER</font> is used to count the
                    number of pages in the report.
                  </p>
                  <p align="left">
                    The <font size="-1">PAGE-COUNTER</font> register can be used
                    as a <font size="-1">SOURCE</font> item in the report but
                    the value of the <font size="-1">PAGE-COUNTER</font> may
                    also be changed by statements in the Procedure Division.
                  </p>
                  <table
                    border="1"
                    width="100%"
                    background="Resources\pics\code.gif"
                  >
                    <tr>
                      <td>
                        <pre>01  TYPE IS PAGE FOOTING.
    02 LINE IS 53.
       03 COLUMN 1      PIC X(29) 
                        VALUE "Programmer - Michael Coughlan".
       03 COLUMN 45     PIC X(6) VALUE "Page :".
       03 COLUMN 52     PIC Z9 SOURCE<B><FONT color="#FF0000"> PAGE-COUNTER.</FONT></B></PRE>
                      </td>
                    </tr>
                  </table>
                </div>
                <hr />
              </td>
            </tr>
            <tr>
              <td
                valign="top"
                align="LEFT"
                width="700"
                bgcolor="#993300"
                colspan="2"
              >
                <h2 align="CENTER">
                  <font color="#FFFF00"
                    ><a name="part6"></a>Procedure Division verbs</font
                  >
                </h2>
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Introduction</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <div align="center">
                  <p align="left">
                    The Report Writer introduces four new verbs for processing
                    reports. These are -
                  </p>
                </div>
                <div align="left">
                  <ol>
                    <ol>
                      <ol>
                        <ol>
                          <li>INITIATE</li>
                          <li>GENERATE</li>
                          <li>TERMINATE</li>
                          <li>SUPPRESS PRINTING</li>
                        </ol>
                      </ol>
                    </ol>
                  </ol>
                </div>
                <div align="center">
                  <p align="left">
                    The first three are normal Procedure Division verbs but the
                    last can only be used in the Declaratives Section.
                  </p>
                  <p align="left">
                    The normal Procedure Division verbs will be covered in this
                    section. Please see the section on Declaratives for the
                    <font size="-1">SUPPRESS PRINTING</font> statement.
                  </p>
                </div>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Syntax</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  <img
                    src="Resources/pics/rwVerbs.gif"
                    width="238"
                    height="144"
                  />
                </p>
                <hr />
                <p>&nbsp;</p>
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >INITIATE</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The <font size="-1">INITIATE</font> statement starts the
                  processing of the <i>ReportName</i> report or reports.
                </p>
                <p>
                  The <i>ReportName</i> must be the name defined for a report in
                  the RD entry in the Report Section.
                </p>
                <p>
                  The <font size="-1">INITIATE</font> statement initializes -
                </p>
                <ul>
                  <li>all the report's sum counters to zero</li>
                  <li>
                    the report <font size="-1">LINE-COUNTER</font> to zero
                  </li>
                  <li>the report <font size="-1">PAGE-COUNTER</font> to one</li>
                </ul>
                <p>
                  Before the <font size="-1">INITIATE</font> statement is
                  executed the file associated with the Report must have been
                  opened for <font size="-1">OUTPUT</font> or
                  <font size="-1">EXTEND</font>.
                </p>
                <hr />
                <p>&nbsp;</p>
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >GENERATE</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The <font size="-1">GENERATE</font> statement drives the
                  production of the report.
                </p>
                <p>
                  The target of a <font size="-1">GENERATE</font> statement is
                  either a <font size="-1">DETAIL</font> report group or a
                  Report Name.
                </p>
                <p>
                  When the target is a <i>ReportName</i> then the report
                  description must contain -
                </p>
                <ul>
                  <li>a <font size="-1">CONTROL</font> clause</li>
                  <li>not more than one <font size="-1">DETAIL</font> group</li>
                  <li>
                    at least one group that is not a
                    <font size="-1">PAGE</font> or
                    <font size="-1">REPORT</font> group.
                  </li>
                </ul>
                <p>
                  When all the <font size="-1">GENERATE </font>statements for a
                  particular report target the <i>ReportName </i>then the report
                  performs summary processing only and the report produced is
                  called a summary report. For instance to make a summary report
                  from the example report all we have to to is to change the
                  <font size="-1">GENERATE </font>statement from -
                </p>
                <blockquote>
                  <blockquote>
                    <blockquote>
                      <blockquote>
                        <p>GENERATE DetailLine.</p>
                        <blockquote>
                          <blockquote>
                            <p>to</p>
                          </blockquote>
                        </blockquote>
                        <p>GENERATE SalesReport.</p>
                      </blockquote>
                    </blockquote>
                  </blockquote>
                </blockquote>
                <p>&nbsp;</p>
                <p>
                  If we specify <font size="-1">GENERATE</font> SalesReport then
                  the <font size="-1">DETAIL</font> group is never printed but
                  the other groups are printed (see the first page of the
                  summary report shown below).
                </p>
                <p>&nbsp;</p>
                <hr />
                <table
                  border="0"
                  width="100%"
                  background="Resources\pics\code.gif"
                >
                  <tr>
                    <td valign="top">
                      <pre>
          An example COBOL Report Program              
     Bible Salesperson - Sales and Salary Report        
                                                        
 City      Salesperson     Sale                         
 Name       Number         Value                        
              Sales for salesperson 1     =      $334.00
              Sales commission is         =       $16.70
              Salesperson salary is       =      $139.70
              Current  salesperson number = 2           
              Previous salesperson number = 1           
                                                        
                                                        
              Sales for salesperson 2     =    $3,667.50
              Sales commission is         =      $183.38
              Salesperson salary is       =      $504.38
              Current  salesperson number = 3           
              Previous salesperson number = 2           
                                                        
                                                        
              Sales for salesperson 3     =      $777.70
              Sales commission is         =       $38.89
              Salesperson salary is       =      $473.89
              Current  salesperson number = 1           
              Previous salesperson number = 3           
                                                        
              Sales for Dublin            =    $4,779.20
              Current city                = 2           
              Previous city               = 1           
                                                        
                                                        
              Sales for salesperson 1     =      $334.00
              Sales commission is         =       $16.70
              Salesperson salary is       =      $139.70
              Current  salesperson number = 2           
              Previous salesperson number = 1           
                                                        
                                                        
              Sales for salesperson 2     =    $2,334.00
              Sales commission is         =      $116.70
              Salesperson salary is       =      $458.70
              Current  salesperson number = 3           
              Previous salesperson number = 2           
                                                        
                                                        
              Sales for salesperson 3     =      $222.20
              Sales commission is         =       $11.11
              Salesperson salary is       =      $122.11
              Current  salesperson number = 4           
              Previous salesperson number = 3           
                                                        
                                                        
                                                        
Programmer - Michael Coughlan               Page :  1   
                                                        
  </pre
                      >
                    </td>
                  </tr>
                </table>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >TERMINATE</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The <font size="-1">TERMINATE</font> statement instructs the
                  Report Writer to complete the processing of the specified
                  report. The Report Writer prints the Page and Report Footings
                  and all the <font size="-1">CONTROL FOOTING</font> groups are
                  printed as if there had been a control break on the most
                  senior control group.
                </p>
                <p>
                  After the report has been terminated the file associated with
                  the report must be closed. For instance in the example program
                  the <i>TERMINATE SalesReport</i> statement is followed by
                  the<i> CLOSE PrintFile </i>statement.
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" bgcolor="#993300" colspan="2">
                <h2 align="CENTER">
                  <font color="#FFFF00" face="Arial, Helvetica, sans-serif"
                    ><a name="part7"></a>Report Writer Declaratives</font
                  >
                </h2>
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Introduction</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  Declaratives are used to extend the functionality of the
                  Report Writer when its standard operations are insufficient of
                  create the desired report. Declaratives extend the
                  functionality of the Report Writer by performing tasks or
                  calculations that the Report Writer can not do automatically
                  or by selectively stopping the report group from being printed
                  (using the <font size="-1">SUPPRESS PRINTING</font> command).
                </p>
                <p>
                  When Declaratives are used with the Report Writer the
                  <font size="-1">USE BEFORE REPORTING</font> phrase allows a
                  programmer to specify that the particular section of code is
                  to be executed before some report group is printed.
                </p>
                <p>
                  Declaratives may also be used to handle file operation errors.
                  In this case the USE clause should use the following syntax -
                </p>
                <p align="center">
                  <img
                    src="Resources/pics/rwUSE1.gif"
                    width="495"
                    height="173"
                  />
                </p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Using Declaratives with the Report Writer</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  When Declaratives are used they must appear as the first item
                  in the Procedure Division.
                </p>
                <p>
                  The Declaratives must be divided into sections and each
                  section must be associated with a particular USE statement.
                </p>
                <p>
                  The USE statement governs when a particular declarative
                  section is executed.
                </p>
                <p>
                  When Declaratives are used with the Report Writer the USE
                  syntax shown below must be used
                </p>
                <p align="center">
                  <img
                    src="Resources/pics/rwUSE2.gif"
                    width="402"
                    height="22"
                  />
                </p>
                <p align="left"><b>Rules:</b></p>
                <p align="left">
                  The ReportGroupName must not appear in more than one USE
                  statement.
                </p>
                <p align="left">
                  The <font size="-1">GENERATE</font>,
                  <font size="-1">INITIATE</font> and
                  <font size="-1">TERMINATE</font> statements must not appear in
                  the Declaratives.
                </p>
                <p align="left">
                  The value of any control data items must not be altered in the
                  Declaratives.
                </p>
                <p align="left">
                  Statements in the Declaratives must not reference
                  non-declarative procedures.
                </p>
                <p align="left">&nbsp;</p>
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Declaratives Example
                  </font>
                </h4>
                <h4>&nbsp;</h4>
              </td>
              <td width="525" valign="top">
                <div align="center">
                  <table
                    border="1"
                    width="90%"
                    background="Resources\pics\code.gif"
                  >
                    <tr>
                      <td>
                        <pre>PROCEDURE DIVISION.
<B><FONT color="#FF0000">DECLARATIVES.
Calc SECTION.
    USE BEFORE REPORTING SalesPersonGrp.
Calculate-Salary.
    MULTIPLY SMS BY Percentage
          GIVING Commission ROUNDED.
    ADD Commission, FixedRate(CityCode,SalesPersonNum)
          GIVING Salary.
END DECLARATIVES.</FONT></B>

Main SECTION.
Begin.
    OPEN INPUT SalesFile.
    OPEN OUTPUT PrintFile.
       : etc :
       : etc : </PRE>
                      </td>
                    </tr>
                  </table>
                </div>
                <p>&nbsp;</p>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >The SUPPRESS PRINTING statement</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <p>
                  The <font size="-1">SUPPRESS PRINTING</font> statement is used
                  in a Declarative section to stop a particular report group
                  from being printed.
                </p>
                <p align="left">
                  The report group suppressed is the one mentioned in the USE
                  statement associated with the section containing the
                  <font size="-1">SUPPRESS PRINTING</font> statement.
                </p>
                <p align="left">
                  The <font size="-1">SUPPRESS PRINTING</font> statement must be
                  executed each time you want to stop the report group from
                  being printed.
                </p>
                <p align="left">
                  In the example below we only want to print the ShopTotalGrp if
                  the sales for the shop are greater than or equal to 10,000.
                </p>
                <table
                  border="1"
                  width="91%"
                  background="Resources\pics\code.gif"
                >
                  <tr>
                    <td>
                      <blockquote>
                        <pre><FONT color="#000000">PROCEDURE DIVISION.
DECLARATIVES.
CheckShopSales SECTION.
    USE BEFORE REPORTING ShopTotalGrp.
PrintMajorShopsOnly.
    IF SalesTotal &lt; 10000<B>
       <FONT color="#FF3300">SUPPRESS PRINTING</FONT>
</B>    END-IF.
END DECLARATIVES.</FONT></PRE>
                      </blockquote>
                    </td>
                  </tr>
                </table>
                <hr />
              </td>
            </tr>
            <tr>
              <td valign="TOP" align="LEFT" width="175" bgcolor="#FFFFCC">
                <h4>
                  <font color="#800000" face="Arial, Helvetica, sans-serif"
                    >Control Break Registers</font
                  >
                </h4>
              </td>
              <td width="525" valign="top">
                <div align="center">
                  <p align="left">
                    A control break occurs when the value in a control break
                    item changes. This causes an interesting problem when the
                    control break item is used as the
                    <font size="-1">SOURCE</font> value in a control footing
                    because by the time the control footing is printed, the
                    control break item no longer contains the correct value.
                    When we print a control footing and refer to a control break
                    item we normally want to access the previous value of the
                    item not the current one.
                  </p>
                  <p align="left">
                    The Report Writer deals with this problem by maintaining a
                    special control break register for each control break item
                    mentioned in the <font size="-1">CONTROLS ARE</font> phrase
                    in the RD entry.
                  </p>
                  <p align="left">
                    When a control break item is referred to in a control
                    footing or in the Declaratives the Report Writer supplies
                    the value held in the control break register and not the
                    value in the item itself.
                  </p>
                  <p align="left">
                    If a control break has just occurred the value in the
                    control break register is the previous value of the control
                    break item.
                  </p>
                  <p align="left">&nbsp;</p>
                </div>
              </td>
            </tr>
            <tr>
              <td align="left" width="700" bgcolor="#FFFFFF" colspan="2">
                <hr />
                <div align="center">
                  <p>
                    <a href="#top">
                      <img
                        src="Resources/pics/i-pagetop.gif"
                        width="132"
                        height="38"
                        border="0"
                    /></a>
                  </p>
                  <hr />
                  <h3 align="center">Copyright Notice</h3>
                  <p align="left">
                    These COBOL course materials are the copyright property of
                    Michael Coughlan.
                  </p>
                  <p align="left">
                    <font size="2"
                      >All rights reserved. No part of these course materials
                      may be reproduced in any form or by any means - graphic,
                      electronic, mechanical, photocopying, printing, recording,
                      taping or stored in an information storage and retrieval
                      system - without the written permission of </font
                    ><font size="2">the author.</font>
                  </p>
                  <p align="center">
                    <font size="2">(c) Michael Coughlan</font>
                  </p>
                  <hr align="left" />
                  <div align="left">
                    <i><font size="-1">Last updated : January 1999</font></i>
                    <br />
                    <font size="-1"
                      ><a href="mailto:michael.coughlan@ul.ie"
                        >e-mail : CSISwebeditor@ul.ie</a
                      ></font
                    >
                  </div>
                </div>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </body>
</html>
